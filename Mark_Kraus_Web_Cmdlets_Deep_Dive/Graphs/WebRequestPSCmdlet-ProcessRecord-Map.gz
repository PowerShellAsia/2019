digraph a {
    rankdir=LR;
    "Invoke-RestMethod" -> "InvokeRestMethodCommand"
    "Invoke-WebRequest" -> "InvokeWebRequestCommand"
    "InvokeRestMethodCommand" -> "WebRequestPSCmlet"
    "InvokeWebRequestCommand" -> "WebRequestPSCmlet"
    "WebRequestPSCmlet" -> "ProcessRecord()"
    node[group="ProcessRecord()"]
    "ValidateParameters()";"PrepareSession()";
    "ProcessRecord()" -> "ValidateParameters()"
    "ProcessRecord()" -> "PrepareSession()"
    "PrepareSession()" -> "ProcessAuthentication()"
    "ProcessRecord()" -> "GetHttpClient()"
    "ProcessRecord()" -> "GetRequest()"
    "GetRequest()" -> "PrepareUri()"
    "PrepareUri()" -> "CheckProtocol()"
    "PrepareUri()" -> "FormatDictionary()"
    "GetRequest()" -> "GetHttpMethod()"
    "ProcessRecord()" -> "FillRequestStream()"
    "FillRequestStream()" -> "SetRequestContent()"
    "ProcessRecord()" -> "GetResponse()"
    "GetResponse()" -> "IsRedirectCode()"
    "GetResponse()" -> "IsRedirectToGet()"
    "GetResponse()" -> "GetHttpClient()"
    "GetResponse()" -> "FillRequestStream()"
    "GetResponse()" -> "ShouldRetry()"
    "ProcessRecord()" -> "Derived Class"
    "Derived Class"->"ProcessResponse()"
    "ProcessRecord()"->"UpdateSession()"
    edge[style=invis];
    "ValidateParameters()"->"PrepareSession()"->"GetHttpClient()"->"GetRequest()"
    "ProcessAuthentication()"->"GetHttpClient()"
    "CheckProtocol()" -> "FormatDictionary()"
    "FormatDictionary()" -> "GetHttpMethod()"
    "GetHttpMethod()" -> "FillRequestStream()"
    "SetRequestContent()" -> "GetResponse()"
    "IsRedirectCode()"->"IsRedirectToGet()"->"ShouldRetry()"
    "ShouldRetry()"->"Derived Class"
    "ProcessResponse()"->"UpdateSession()"
}